# Learn more about services, parameters and containers at
# http://symfony.com/doc/current/service_container.html
parameters:
#    parameter_name: value

services:

  app.repository.post:
    class: AppBundle\Repository\PostRepository
    factory: ['@doctrine.orm.entity_manager', getRepository]
    arguments: [ AppBundle:Post ]
    public: false

  app.service.blog_manager:
    class: AppBundle\Service\BlogManager
    arguments:
      - '@app.repository.post'
      - '@event_dispatcher'

  app.event.listener.post_access_count_increment:
    class: AppBundle\Event\Listener\PostAccessCountIncrementListener
    tags:
      - { name: kernel.event_listener, event: post.fetched, event: onPostFetch }
    arguments:
      - '@doctrine.orm.entity_manager'

  app.sonata.admin.post:
    class: AppBundle\Admin\PostAdmin
    tags:
      - { name: sonata.admin, manager_type: orm, group: "Blog Management", label: "Posts"}
    arguments: [~, AppBundle\Entity\Post, ~]
    calls:
      - [ setTranslationDomain, [AppBundle]]
